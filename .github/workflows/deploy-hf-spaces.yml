name: è‡ªåŠ¨éƒ¨ç½²åˆ°Hugging Face Spaces

on:
  push:
    branches:
      - main
    paths:
      - 'platform/hf_spaces_app_mysql.py'
      - 'platform/hf_spaces_requirements.txt'
      - 'platform/Dockerfile_hf'
      - 'platform/hf_spaces_readme.md'
      - 'scripts/deploy_hf.py'
      - '.github/workflows/deploy-hf-spaces.yml'

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v3
      
      - name: è®¾ç½®Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: å®‰è£…ä¾èµ–
        run: |
          pip install -q huggingface-hub
      
      - name: éƒ¨ç½²åˆ°Hugging Face Spaces
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          python scripts/deploy_hf.py
      
      - name: éƒ¨ç½²æˆåŠŸé€šçŸ¥
        if: success()
        run: |
          echo "âœ… åº”ç”¨å·²æˆåŠŸéƒ¨ç½²åˆ°Hugging Face Spaces"
          echo "ğŸ“ è®¿é—®é“¾æ¥: https://junk1107-ai-labor-platform.hf.space"
      
      - name: éƒ¨ç½²å¤±è´¥é€šçŸ¥
        if: failure()
        run: |
          echo "âŒ éƒ¨ç½²å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ—¥å¿—"
          exit 1
