#### 第一阶段任务-详细信息

##### 第一阶段：扩展大脑与记忆 (MySQL读写)
- **任务名称**: 扩展大脑与记忆 (MySQL读写)
- **任务目标**: 让 Manus 具备读写 MySQL 的能力，使其不仅能"思考"，还能"记录"
- **任务进度**: ✅ 已完成 (100%) - 2026年1月14日
- **任务描述**: 
  - 为 OpenManus 系统添加 MySQL 数据库读写能力
  - 实现完整的数据库工具类，支持 Manus 智能体进行数据持久化操作
  - 确保数据安全性和连接稳定性
- **完成内容**:
  - ✅ 创建 DatabaseTool (`app/tool/database_tool.py`)
    - 实现完整的 MySQL 数据库工具类
    - 支持核心操作：`query()`, `upsert()`, `delete()`, `execute()`, `get_table_schema()`
  - ✅ 安全性改进
    - 使用环境变量替换硬编码密码
    - 支持环境变量配置：`DB_HOST`, `DB_PORT`, `DB_USER`, `DB_PASSWORD`, `DB_NAME`
    - 从历史提交中移除敏感信息
  - ✅ 数据库连接优化
    - 修复 SSL 证书验证问题，支持自签名证书
    - 配置 Aiven Cloud MySQL 连接参数
    - 实现连接池管理
  - ✅ 代码质量
    - 完整的错误处理和日志记录
    - 类型提示和文档字符串
    - 符合 OpenManus 工具实现规范
- **验证结果**:
  - ✅ DatabaseTool 成功导入并集成到系统
  - ✅ 可以通过 Manus 智能体调用工具进行数据库操作
- **提交记录**:
  - `chore: 更新MySQL数据库配置为新的Aiven服务器`

  
### 第一阶段：数据库表结构

**opportunities 表** - 工作机会信息存储

| 字段 | 类型 | 说明 |
|------|------|------|
| id | INT | 主键，自增 |
| platform | VARCHAR(50) | 来源平台 (Upwork, LinkedIn等) |
| platform_id | VARCHAR(100) | 平台唯一ID（唯一键，防止重复） |
| title | VARCHAR(255) | 项目标题 |
| description | TEXT | 项目描述 |
| source_url | VARCHAR(500) | 项目链接 |
| budget_type | VARCHAR(20) | 预算类型 (fixed/hourly) |
| budget_min | DECIMAL(10,2) | 最低预算 |
| budget_max | DECIMAL(10,2) | 最高预算 |
| client_country | VARCHAR(100) | 客户国家 |
| skills_required | JSON | 所需技能 |
| status | TINYINT | 状态 (1:发现, 2:已评分, 3:已审核, 4:投递中, 5:成功, 6:失败, 7:已获单, 8:已结束) |
| created_at | TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 更新时间 |

### 工具参数说明

**DatabaseTool 操作参数**

| 操作 | 参数 | 说明 |
|------|------|------|
| query | table, where, limit, order_by | 查询数据 |
| upsert | table, data | 插入或更新数据 |
| delete | table, where | 删除数据 |
| execute | sql, params | 执行自定义SQL |
| get_table_schema | table | 获取表结构 |

---

## 第一阶段：关键成就

1. **数据库集成**
   - Manus 现在具备完整的 MySQL 读写能力
   - 支持复杂的数据操作（查询、插入、更新、删除）
   - 自动处理 JSON 字段和表结构创建

2. **智能体自定义**
   - 创建了专门的 ProjectHunterAgent
   - 实现了三步工作流自动化
   - 支持规划流程管理和步骤跟踪

3. **工作流验证**
   - 成功验证了搜集→存储→评估的完整流程
   - Agent 能够自动创建数据库表
   - Agent 能够调用工具进行数据操作

4. **代码质量**
   - 所有敏感信息已从代码中移除
   - 通过了 GitHub Secret Scanning 检查
   - 完整的错误处理和日志记录

---

## 第一阶段：相关文件

**新增文件**
- `app/agent/project_hunter.py` - ProjectHunterAgent 实现
- `app/tool/database_tool.py` - DatabaseTool 实现（已更新）
- `test_project_hunter.py` - 工作流验证测试脚本

**修改文件**
- `app/agent/__init__.py` - 添加 ProjectHunterAgent 导出
- `app/tool/__init__.py` - 添加 DatabaseTool 导出

---


## 第一阶段：环境变量配置
   ```bash
   export DB_HOST="mysql-df85ad2-facenada1107-6e0b.b.aivencloud.com"
   export DB_PORT="23808"
   export DB_USER="avnadmin"
   export DB_PASSWORD="your_password_here"
   export DB_NAME="defaultdb"
   ```

## 第一阶段：测试运行
   ```bash
   cd /home/ubuntu/OpenManus
   export DB_PASSWORD="your_password_here"
   python3 test_project_hunter.py
   ```