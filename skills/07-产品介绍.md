# OpenManus 新增功能规划

## 📋 目录
## 系统概览
远程项目承包平台：自动爬取远程工作机会，通过AI智能分析，人工审核通过后自动投递简历。

### 核心价值链
```
多平台平台 → 爬取机会 → 职能分析评分 → 人工审核(手动改数据库状态) →  自动投递 → 获得订单
```

## 功能模块
### 机会管理模块 (Opportunity Management)

**功能描述**: 自动爬取、智能分析、人工审核、自动投递远程工作机会

**核心子功能**:
- **机会爬取**: Upwork、Toptal、LinkedIn等平台爬虫
- **机会分析**: LLM智能评分、技能匹配度、预期收入评估、风险评估
- **机会投递**: 人工审核机会、自动投递简历
**数据流**:
```
爬虫 → 原始数据 → LLM分析 → 评分分类 → 数据库存储 → 人工审核(手动改数据库状态) → 自动投递
```
**关键指标**:
- 每日爬取数量
- 投递成功率
- 获单率
- 平均项目价值
---


## 核心流程

### 流程1: 机会获取和投递流程

```
1. 定时爬虫启动 (每5秒)
   ↓
2. 爬取多个平台的工作机会 (Upwork/Toptal/LinkedIn)
   ↓
3. 原始数据清洗和标准化
   ↓
4. LLM智能分析 (评分0-100、技能匹配、收入评估、风险评估)
   ↓
5. 保存到数据库
   ↓
6. 人工审核通过(手动改数据库状态)
   ↓
7. 自动投递简历 (生成个性化提案、提交到平台)
   ↓
8. 跟踪投递状态 (等待回复/获得面试/获得订单/被拒绝)
```


## 数据模型

### 核心表结构
#### 3. opportunities 表 (工作机会)
```sql
CREATE TABLE `opportunities` (
    `id` INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
    
    -- 基础抓取信息
    `platform` VARCHAR(20) NOT NULL COMMENT '来源平台: upwork, toptal, linkedin, freelancer',
    `platform_id` VARCHAR(100) UNIQUE NOT NULL COMMENT '原始平台唯一ID，防止重复抓取',
    `title` VARCHAR(255) NOT NULL COMMENT '项目标题',
    `description` TEXT COMMENT '原始项目描述',
    `source_url` VARCHAR(500) NOT NULL COMMENT '项目详情链接',
    
    -- 核心商业指标
    `budget_type` ENUM('fixed', 'hourly') DEFAULT 'fixed' COMMENT '预算类型',
    `budget_min` DECIMAL(10, 2) DEFAULT 0.00 COMMENT '最低预算',
    `budget_max` DECIMAL(10, 2) DEFAULT 0.00 COMMENT '最高预算',
    `client_country` VARCHAR(50) COMMENT '客户国家(避开某些低价区)',
    `client_rating` FLOAT DEFAULT 0.0 COMMENT '客户历史评分',
    
    -- AI 智能决策字段 (赚钱核心)
    `ai_score` TINYINT DEFAULT 0 COMMENT 'AI 综合评分 0-100',
    `ai_match_reason` TEXT COMMENT 'AI 推荐理由/技术匹配点',
    `ai_proposal_draft` TEXT COMMENT 'AI 生成的初稿',
    `skills_required` JSON COMMENT '解析出的技能标签 ["Python", "React"]',
    
    -- 自动化流程控制
    `status` TINYINT NOT NULL DEFAULT 1 
        COMMENT '1:发现任务, 2:AI已评分, 3:人工已审核, 4:投递中, 5:投递成功, 6:投递失败, 7:已获单, 8:忽略/已结束',
    `retry_count` TINYINT DEFAULT 0 COMMENT '投递失败重试次数',
    `error_log` TEXT COMMENT '失败原因记录',
    
    -- 时间线
    `published_at` TIMESTAMP NULL COMMENT '平台发布时间',
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '本地抓取时间',
    `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    `applied_at` TIMESTAMP NULL COMMENT '实际投递时间',

    -- 索引优化
    INDEX `idx_status_score` (`status`, `ai_score`),
    INDEX `idx_platform` (`platform`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

CREATE TABLE `crawl_targets` (
    `id` INT UNSIGNED PRIMARY KEY AUTO_INCREMENT,
    `platform` VARCHAR(20) NOT NULL COMMENT '平台名称: upwork, linkedin, web_url',
    `keywords` VARCHAR(255) NOT NULL COMMENT '搜索关键词，如: Python Backend, React Expert',
    `category` VARCHAR(50) COMMENT '任务分类，方便后期归类',
    
    -- 控制参数
    `is_active` TINYINT DEFAULT 1 COMMENT '是否启用: 1启用, 0禁用',
    `interval_minutes` INT DEFAULT 60 COMMENT '抓取频率(分钟)',
    `last_crawl_at` TIMESTAMP NULL COMMENT '上次抓取时间',
    
    -- 进阶配置
    `min_budget` DECIMAL(10, 2) DEFAULT 0 COMMENT '该配置下的最低预算过滤',
    `preferred_countries` JSON COMMENT '倾向的客户国家列表',
    
    `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- 插入 3 个目标网站配置
INSERT INTO `crawl_targets` (`platform`, `keywords`, `category`, `interval_minutes`, `min_budget`) VALUES 
('Upwork', 'Python AI Agent', 'Backend', 30, 500),
('LinkedIn', 'Remote Python Developer', 'Fullstack', 60, 3000),
('Target_Site_3', 'Web3 Go Engineer', 'Blockchain', 120, 1000);
```
